var colors=["#ABC8E4","#628CB6","#003366","#001948","#001948","#001948","#001948"],imported=!1;function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var results=new RegExp("[\\?&]"+name+"=([^&#]*)").exec(location.search);return null==results?"":decodeURIComponent(results[1].replace(/\+/g," "))}var key=getParameterByName("key");if(key){var gridIds=["1","o6d"];function getFromGoogle(i){$.ajax({url:"https://spreadsheets.google.com/feeds/list/"+key+"/"+gridIds[i]+"/public/values?alt=json",type:"get",dataType:"jsonp",error:function(){i+1<gridIds.length&&getFromGoogle(i+1)},timeout:5e3,success:function(list){var keys=[];for(var name in list.feed.entry[0])0==name.indexOf("gsx$")&&keys.push(name);for(var firstName=!1,lastName=!1,fullName=!1,i=0;i<keys.length;i++)0<keys[i].toLowerCase().indexOf("first")&&(firstName=keys[i]),0<keys[i].toLowerCase().indexOf("last")&&(lastName=keys[i]),0<keys[i].toLowerCase().indexOf("name")&&(fullName=keys[i]);var names=list.feed.entry.map(function(entry){return firstName&&lastName?entry[firstName].$t+" "+entry[lastName].$t:firstName?entry[firstName].$t:lastName?entry[lastName].$t:!!fullName&&entry[fullName].$t}).filter(function(name){return name}).map(function(name){return{name:name}});0<names.length&&(imported=names,$(".enter-names").hide(),makeTicketsWithPoints())}})}getFromGoogle(0)}